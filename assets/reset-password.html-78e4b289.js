import{_ as t,r as o,o as i,c as p,d as s,e as a,b as e,a as r}from"./app-3d979d38.js";const l={},c=s("h1",{id:"mysql重置密码",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#mysql重置密码","aria-hidden":"true"},"#"),a(" mysql重置密码")],-1),d=s("h2",{id:"配置source",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#配置source","aria-hidden":"true"},"#"),a(" 配置source")],-1),m={href:"https://dev.mysql.com/downloads/",target:"_blank",rel:"noopener noreferrer"},u=r(`<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> dpkg <span class="token parameter variable">-i</span> mysql_.deb
<span class="token function">sudo</span> <span class="token function">apt</span> update 
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> mysql-server
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后就安装好了</p><h2 id="配置mysql的远程root用户访问权限" tabindex="-1"><a class="header-anchor" href="#配置mysql的远程root用户访问权限" aria-hidden="true">#</a> 配置mysql的远程root用户访问权限</h2><ol><li>命令行登录 mysql,输入用户名，密码</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># mysql -u root -p</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>2.切换到 mysql库</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>use mysql<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>3.查看用户表,可以看到当前host是localhost,只允许本地访问</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> host,user from user<span class="token punctuation">;</span>
+-----------+------------------+
<span class="token operator">|</span> <span class="token function">host</span>      <span class="token operator">|</span> user             <span class="token operator">|</span>
+-----------+------------------+
<span class="token operator">|</span> localhost <span class="token operator">|</span> root             <span class="token operator">|</span>
+-----------+------------------+
<span class="token number">1</span> rows <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4.更新user用户表</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mysql<span class="token operator">&gt;</span> update user <span class="token builtin class-name">set</span> <span class="token variable"><span class="token variable">\`</span><span class="token function">host</span><span class="token variable">\`</span></span> <span class="token operator">=</span> <span class="token string">&#39;%&#39;</span>  where <span class="token variable"><span class="token variable">\`</span>user<span class="token variable">\`</span></span> <span class="token operator">=</span> <span class="token string">&#39;root&#39;</span>  LIMIT <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>5.分配所有访问权限,如果已分配过，该步骤可跳过</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mysql<span class="token operator">&gt;</span> GRANT ALL PRIVILEGES ON *.* TO <span class="token string">&#39;root&#39;</span>@<span class="token string">&#39;%&#39;</span> IDENTIFIED BY <span class="token string">&#39;root密码&#39;</span> WITH GRANT OPTION<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>6.强制刷新权限</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mysql<span class="token operator">&gt;</span> flush privileges<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>7.再次查看用户表,root用户的host变成%，即允许所有的ip远程访问，如果需要指定具体的ip，就写上具体的ip即可</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> host,user from user<span class="token punctuation">;</span>
+-----------+------------------+
<span class="token operator">|</span> Host      <span class="token operator">|</span> User             <span class="token operator">|</span>
+-----------+------------------+
<span class="token operator">|</span> %         <span class="token operator">|</span> root             <span class="token operator">|</span>
+-----------+------------------+
<span class="token number">1</span> rows <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="修改mysql配置文件my-cnf" tabindex="-1"><a class="header-anchor" href="#修改mysql配置文件my-cnf" aria-hidden="true">#</a> 修改mysql配置文件my.cnf</h2><p>1.使用命令<code>netstat -an|grep 3306</code> 查看端口监听状态如下所示，绑定了127.0.0.1，只允许本地访问，需要修改配置文件：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># netstat -an|grep 3306</span>
tcp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">127.0</span>.0.1:3306          <span class="token number">0.0</span>.0.0:*               LISTEN
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>2.修改my.cnf，注释掉<code>bind-address 127.0.0.1</code>属性，修改后如下图所示</p><p><img src="https://upload-images.jianshu.io/upload_images/6597489-5e9f258ab9966494.png?imageMogr2/auto-orient/strip|imageView2/2/w/477/format/webp#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=xjPeI&amp;originHeight=71&amp;originWidth=477&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="bind"></p><p>注释掉bind-address</p><p>3.重启mysql服务<code>service mysql restart</code>,再次使用命令<code>netstat -an|grep 3306</code>查看端口监听状态</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># netstat -an|grep 3306</span>
tcp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">127.0</span>.0.1:55074         <span class="token number">127.0</span>.0.1:3306          TIME_WAIT  
tcp6       <span class="token number">0</span>      <span class="token number">0</span> :::3306                 :::*                    LISTEN
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="配置阿里云安全组规则" tabindex="-1"><a class="header-anchor" href="#配置阿里云安全组规则" aria-hidden="true">#</a> 配置阿里云安全组规则</h2><p>登录阿里云进入控制台，依次访问<strong>网络和安全-&gt;安全组-&gt;配置规则</strong>，在入方向上开放MySQL监听端口3306即可，如下所示</p><p><img src="https://upload-images.jianshu.io/upload_images/6597489-03199ab0f8ad6c89.png?imageMogr2/auto-orient/strip|imageView2/2/w/943/format/webp#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=ggs1O&amp;originHeight=66&amp;originWidth=943&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""></p><p>开放mysql的3306端口</p><p>到此，阿里云服务器的MYSQL数据库远程访问开启成功，使用客户端测试连接成功。</p><p>​</p><h2 id="mysql" tabindex="-1"><a class="header-anchor" href="#mysql" aria-hidden="true">#</a> mysql</h2><p>注意一点 <code>Java时间比数据库时间早8小时，设置 serverTimezone=Asia/Shanghai</code> ​</p><h3 id="忘记密码" tabindex="-1"><a class="header-anchor" href="#忘记密码" aria-hidden="true">#</a> 忘记密码</h3>`,34),h={href:"https://dev.mysql.com/doc/refman/8.0/en/resetting-permissions.html#resetting-permissions-windows",target:"_blank",rel:"noopener noreferrer"};function b(v,g){const n=o("ExternalLinkIcon");return i(),p("div",null,[c,d,s("p",null,[s("a",m,[a("https://dev.mysql.com/downloads/"),e(n)]),a(" 下载mysql8的config文件,然后在ubuntu上安装")]),u,s("p",null,[s("a",h,[a("https://dev.mysql.com/doc/refman/8.0/en/resetting-permissions.html#resetting-permissions-windows"),e(n)])])])}const y=t(l,[["render",b],["__file","reset-password.html.vue"]]);export{y as default};
