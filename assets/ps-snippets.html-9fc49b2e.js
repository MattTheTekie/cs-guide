import{_ as l,r as o,o as t,c as i,d as s,e as n,b as a,a as r}from"./app-3d979d38.js";const p={},c=s("h1",{id:"我的posh片段",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#我的posh片段","aria-hidden":"true"},"#"),n(" 我的posh片段")],-1),d=s("h2",{id:"powershell的库",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#powershell的库","aria-hidden":"true"},"#"),n(" Powershell的库")],-1),u={href:"https://www.powershellgallery.com/",target:"_blank",rel:"noopener noreferrer"},h=s("br",null,null,-1),v={href:"https://www.computerperformance.co.uk/powershell/",target:"_blank",rel:"noopener noreferrer"},m=r(`<h2 id="start-process-别名-start-路径-打开当前文件夹" tabindex="-1"><a class="header-anchor" href="#start-process-别名-start-路径-打开当前文件夹" aria-hidden="true">#</a> Start-Process，别名：start + 路径， 打开当前文件夹</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token comment"># 以管理员身份启动Powershell</span>
<span class="token function">start</span> <span class="token operator">-</span>FilePath <span class="token string">&quot;powershell&quot;</span> <span class="token operator">-</span>Verb RunAs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="get-history-别名-history、h-列出之前的操作命令" tabindex="-1"><a class="header-anchor" href="#get-history-别名-history、h-列出之前的操作命令" aria-hidden="true">#</a> Get-History，别名：history、h，列出之前的操作命令</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>history
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="get-process-别名-ps-查找进程-可以通过进程名称或者进程id来获取特定进程" tabindex="-1"><a class="header-anchor" href="#get-process-别名-ps-查找进程-可以通过进程名称或者进程id来获取特定进程" aria-hidden="true">#</a> Get-Process， 别名：ps，查找进程, 可以通过进程名称或者进程ID来获取特定进程</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token function">Get-Process</span> qq
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="remove-item-别名-rm、del-删除或删除文件" tabindex="-1"><a class="header-anchor" href="#remove-item-别名-rm、del-删除或删除文件" aria-hidden="true">#</a> remove-item，别名： rm、del, 删除或删除文件</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="get-location-别名-pwd-当前目录位置" tabindex="-1"><a class="header-anchor" href="#get-location-别名-pwd-当前目录位置" aria-hidden="true">#</a> get-location，别名：pwd, 当前目录位置</h2><h2 id="get-help-缩写help-查看命令的帮助" tabindex="-1"><a class="header-anchor" href="#get-help-缩写help-查看命令的帮助" aria-hidden="true">#</a> get-help, 缩写help，查看命令的帮助</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>help <span class="token function">get-process</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="get-host" tabindex="-1"><a class="header-anchor" href="#get-host" aria-hidden="true">#</a> get-host</h2><h2 id="get-date-别名-date-获取系统当前时间" tabindex="-1"><a class="header-anchor" href="#get-date-别名-date-获取系统当前时间" aria-hidden="true">#</a> get-date, 别名：date，获取系统当前时间</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token function">get-date</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="get-content-别名-cat-输出文件内容到控制台" tabindex="-1"><a class="header-anchor" href="#get-content-别名-cat-输出文件内容到控制台" aria-hidden="true">#</a> get-content，别名：cat, 输出文件内容到控制台</h2><h2 id="获取命令的位置" tabindex="-1"><a class="header-anchor" href="#获取命令的位置" aria-hidden="true">#</a> 获取命令的位置</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code> <span class="token function">Get-Command</span> <span class="token operator">-</span>Name npm
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="获取命令所在目录" tabindex="-1"><a class="header-anchor" href="#获取命令所在目录" aria-hidden="true">#</a> 获取命令所在目录</h3><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token function">start</span> <span class="token punctuation">(</span><span class="token function">Get-Item</span> <span class="token punctuation">(</span><span class="token function">Get-Command</span> <span class="token operator">-</span>Name npm<span class="token punctuation">)</span><span class="token punctuation">.</span>Source<span class="token punctuation">)</span><span class="token punctuation">.</span>Directory
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="获取系统的编码" tabindex="-1"><a class="header-anchor" href="#获取系统的编码" aria-hidden="true">#</a> 获取系统的编码</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>chcp
活动代码页: 936 这个是gbk编码
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="下载文件" tabindex="-1"><a class="header-anchor" href="#下载文件" aria-hidden="true">#</a> 下载文件</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>
<span class="token function">iwr</span> <span class="token string">&quot;http://p9.pstatp.com&quot;</span> <span class="token operator">-</span>Outfile a<span class="token punctuation">.</span>webp
或者
curl <span class="token string">&#39;http:www.baidu.com&#39;</span> <span class="token operator">-</span>o a<span class="token punctuation">.</span>webp
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以使用openfiles这个命令，和linux下的lsof差不多 不过系统默认是关闭这个功能，要使用这个功能，需要先激活。 激活命令：</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>openfiles <span class="token operator">/</span>local on
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后重启电脑 然后就可以使用了，下面命令可以查询。</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>openfiles <span class="token operator">/</span>query <span class="token operator">/</span>v
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>不用了别忘记关闭它</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>openfiles <span class="token operator">/</span>local off
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="执行exe或者可执行文件" tabindex="-1"><a class="header-anchor" href="#执行exe或者可执行文件" aria-hidden="true">#</a> 执行exe或者可执行文件</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token punctuation">.</span>\\fileName 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="清屏" tabindex="-1"><a class="header-anchor" href="#清屏" aria-hidden="true">#</a> 清屏</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>clear<span class="token punctuation">|</span>cls 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="查看版本" tabindex="-1"><a class="header-anchor" href="#查看版本" aria-hidden="true">#</a> 查看版本</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token variable">$host</span><span class="token punctuation">.</span>version
<span class="token comment">#  或者</span>
<span class="token function">Get-Host</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="获取当前进程" tabindex="-1"><a class="header-anchor" href="#获取当前进程" aria-hidden="true">#</a> 获取当前进程</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token function">Get-Process</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="关闭某进程" tabindex="-1"><a class="header-anchor" href="#关闭某进程" aria-hidden="true">#</a> 关闭某进程</h3><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token variable">$process</span> =<span class="token string">&quot;*powershellw*&quot;</span>
<span class="token comment"># 查找和powershellw相关的进程</span>
<span class="token function">Get-CimInstance</span> Win32_Process <span class="token punctuation">|</span> Where <span class="token punctuation">{</span><span class="token variable">$_</span><span class="token punctuation">.</span>CommandLine <span class="token operator">-like</span> <span class="token variable">$process</span> <span class="token punctuation">}</span> <span class="token punctuation">|</span> <span class="token function">select</span> <span class="token operator">-</span>ExpandProperty CommandLine <span class="token comment"># | Measure-Object -Line</span>
<span class="token comment"># 关闭powershellw进程</span>
<span class="token function">Get-CimInstance</span> Win32_Process <span class="token punctuation">|</span> Where <span class="token punctuation">{</span><span class="token variable">$_</span><span class="token punctuation">.</span>CommandLine <span class="token operator">-like</span> <span class="token variable">$process</span><span class="token punctuation">}</span> <span class="token punctuation">|</span> <span class="token function">Remove-CimInstance</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="查看进程的命令行" tabindex="-1"><a class="header-anchor" href="#查看进程的命令行" aria-hidden="true">#</a> 查看进程的命令行</h3><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token comment"># 获取powershell进程的命令行</span>
<span class="token function">Get-CimInstance</span> Win32_Process <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token string">&quot;name = &#39;powershell.exe&#39;&quot;</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> CommandLine
<span class="token comment"># 获取命令行带有zfile.jar的命令行</span>
<span class="token function">Get-CimInstance</span> Win32_Process  <span class="token punctuation">|</span> <span class="token function">Where-Object</span> CommandLine <span class="token operator">-Match</span> <span class="token string">&#39;zfile&#39;</span><span class="token punctuation">|</span> <span class="token function">Remove-CimInstance</span>

<span class="token comment"># 关闭某进程</span>
<span class="token function">Stop-Process</span> <span class="token operator">-</span>Id 34328
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="查看端口被哪个进程占用" tabindex="-1"><a class="header-anchor" href="#查看端口被哪个进程占用" aria-hidden="true">#</a> 查看端口被哪个进程占用</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token function">Get-Process</span> <span class="token operator">-</span>Id <span class="token punctuation">(</span><span class="token function">Get-NetTCPConnection</span> <span class="token operator">-</span>LocalPort 5000<span class="token punctuation">)</span><span class="token punctuation">.</span>OwningProcess
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="重命名" tabindex="-1"><a class="header-anchor" href="#重命名" aria-hidden="true">#</a> 重命名</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token function">Rename-Item</span> FileName <span class="token operator">-</span>NewName NewFileName
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="批量重命名" tabindex="-1"><a class="header-anchor" href="#批量重命名" aria-hidden="true">#</a> 批量重命名</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token variable">$i</span> = 0
 
<span class="token function">Get-ChildItem</span> <span class="token operator">-</span>Path D:\\pictures <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token operator">*</span><span class="token punctuation">.</span>jpg <span class="token punctuation">|</span>
<span class="token function">ForEach-Object</span> <span class="token punctuation">{</span>
    <span class="token variable">$extension</span> = <span class="token variable">$_</span><span class="token punctuation">.</span>Extension
    <span class="token variable">$newName</span> = <span class="token string">&#39;pic_{0:d6}{1}&#39;</span> <span class="token operator">-</span>f <span class="token variable">$i</span><span class="token punctuation">,</span> <span class="token variable">$extension</span>
    <span class="token variable">$i</span><span class="token operator">++</span>
    <span class="token function">Rename-Item</span> <span class="token operator">-</span>Path <span class="token variable">$_</span><span class="token punctuation">.</span>FullName <span class="token operator">-</span>NewName <span class="token variable">$newName</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token function">type</span> &gt; <span class="token operator">%</span>~dp0\\a<span class="token punctuation">.</span>txt
<span class="token comment"># 新建文件</span>
<span class="token function">echo</span> a 2&gt;FileName
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="添加参数" tabindex="-1"><a class="header-anchor" href="#添加参数" aria-hidden="true">#</a> 添加参数</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token keyword">param</span> <span class="token punctuation">(</span>
    <span class="token namespace">[String]</span><span class="token variable">$Type</span> = <span class="token string">&quot;run&quot;</span>
<span class="token punctuation">)</span>
<span class="token variable">$name</span> = <span class="token string">&quot;server&quot;</span>
<span class="token variable">$curDir</span> = <span class="token function">Split-Path</span> <span class="token operator">-</span>Parent <span class="token variable">$MyInvocation</span><span class="token punctuation">.</span>MyCommand<span class="token punctuation">.</span>Definition
<span class="token function">Write-Host</span> <span class="token string">&quot;当前路径&quot;</span><span class="token variable">$curDir</span>   <span class="token operator">-</span>ForegroundColor Yellow
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$Type</span> <span class="token operator">-eq</span> <span class="token string">&quot;run&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Write-Host</span> <span class="token string">&quot;运行&quot;</span> <span class="token operator">-</span>ForegroundColor Cyan
    <span class="token function">Write-Host</span> <span class="token string">&quot;go run main.go&quot;</span> <span class="token operator">-</span>ForegroundColor Cyan 
<span class="token punctuation">}</span>
<span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token variable">$Type</span> <span class="token operator">-eq</span> <span class="token string">&quot;build&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Write-Host</span> <span class="token string">&quot;编译&quot;</span> <span class="token operator">-</span>ForegroundColor Red
    <span class="token function">Write-Host</span> <span class="token string">&quot;go build&quot;</span> <span class="token operator">-</span>ForegroundColor Cyan
   
    
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用<code>.\\addParam.ps1 -Type</code> 输入 <code>-</code>会自动弹出-Type</p><h2 id="获取文件夹大小" tabindex="-1"><a class="header-anchor" href="#获取文件夹大小" aria-hidden="true">#</a> 获取文件夹大小</h2><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>
<span class="token keyword">param</span> <span class="token punctuation">(</span>
    <span class="token namespace">[string]</span> <span class="token variable">$folder</span>
<span class="token punctuation">)</span>
    
<span class="token function">Get-ChildItem</span> <span class="token operator">-</span>Path <span class="token variable">$folder</span> <span class="token operator">-</span>Force <span class="token operator">-</span>Recurse <span class="token operator">-</span>ErrorAction SilentlyContinue <span class="token punctuation">|</span>
<span class="token function">Where-Object</span> <span class="token punctuation">{</span> <span class="token variable">$_</span><span class="token punctuation">.</span>PSIsContainer <span class="token operator">-eq</span> <span class="token boolean">$false</span> <span class="token punctuation">}</span> <span class="token punctuation">|</span>
<span class="token function">Measure-Object</span> <span class="token punctuation">|</span>  <span class="token function">Select-Object</span> <span class="token operator">-</span>ExpandProperty Count
<span class="token function">Write-Host</span>  <span class="token string">&quot;文件数量检测完毕&quot;</span> <span class="token operator">-</span>ForegroundColor Cyan
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,53);function k(b,g){const e=o("ExternalLinkIcon");return t(),i("div",null,[c,d,s("p",null,[s("a",u,[n("https://www.powershellgallery.com/"),a(e)]),h,n(" 部分教程 "),s("a",v,[n("链接"),a(e)])]),m])}const f=l(p,[["render",k],["__file","ps-snippets.html.vue"]]);export{f as default};
